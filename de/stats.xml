<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
  "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">


<!-- $Id: stats.xml,v 1.28 2011-05-31 13:03:49 mg Exp $ -->
<chapter id="statistic-module">
<title>Statistikmodul</title>

<para>
Das OTRS-Statistikmodul enthält Funktionen, um betriebliche Kennziffern zu
überwachen und angepasste Reports der Verwendung von OTRS zu erstellen. In
OTRS wird der Begriff "Stat/Statistik" für einen Report benutzt, der
verschiedene Indikatoren abbildet.
</para>

<para>
Eine sinnvolle Konfiguration des OTRS-Statistikmoduls ist verbunden mit
einer Vielzahl von Anforderungen und Überlegungen. Darin eingeschlossen sind
die auszuwertenden Module von OTRS, Benutzerrechte, zu berechnende
Indikatoren und ihre Komplexitätsgrade, eine einfache Konfiguration des
Statistikmoduls, Geschwindigkeit und Effizienz der Berechnungen, und die
Unterstützung verschiedener Ausgabevarianten.
</para>

<para>
Um komplexe Statistiken abzubilden, besteht ferner die Möglichkeit statische
Elemente zu integrieren (Dateien, die die Funktionalität des
Statistik-Moduls um ganz spezifische Anforderungen ergänzen).
</para>

<section id="stats-usage" >
<title>Bedienung des Moduls durch den Agent</title>

<para>
Wenn man als Agent angemeldet ist, erscheint der Menüpunkt "Statistik" mit
verschiedenen Unterpunkten, siehe Abb. 19.1.
</para>

<para>
<screenshot>
<screeninfo>Das Statistikmodul</screeninfo> <graphic
fileref="screenshots/stats-menu.png" scale="40" srccredit="stats-menu -
Screenshot" /></screenshot>
</para>

<para>
<emphasis>Abb. 3.7. Statistikmenü.</emphasis>
</para>

<para>
Folgende Optionen sind im Statistikmenü verfügbar:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
            <emphasis>Übersicht</emphasis>. Zeigt eine Liste vorkonfigurierter Reports
an.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>Neu</emphasis>. Benötigt "rw"-Rechte.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>Importieren</emphasis>. Benötigt "rw"-Rechte.
        </para>
    </listitem>
</itemizedlist>
</para>

<section id="stats-overview" >
<title>Übersicht</title>

<para>
Die Auswahl von "Statistik" und des Unterpunktes "Übersicht" ruft den
Übersichtsbildschirm auf. Hier wird dem Agenten eine Liste von
vorkonfigurierten Reports präsentiert, die er verwenden kann.

</para>

<para>
<screenshot>
<screeninfo>Übersicht der Standardstatistiken</screeninfo> <graphic
fileref="screenshots/stats-overview.png" scale="40"
srccredit="stats-overview - Screenshot" /></screenshot>
</para>

<para>
<emphasis>Abb. 19.2. Übersicht der Standardstatistiken.</emphasis>
</para>

<para>
Folgende Informationen sind den in der Übersicht aufgelisteten Statistiken
zu entnehmen:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
            <emphasis>Stat#</emphasis>. Eindeutige Statistiknummer.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>Titel</emphasis>. Titel der Statistik.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>Objekt</emphasis>. Objekt, das für die Generierung der Statistik
verwendet wird. Wenn es sich um eine statische Statistik handelt, wird kein
Objekt angezeigt, da kein dynamisches Objekt zur Generierung verwendet
wird.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>Beschreibung</emphasis>. Ein Auszug aus der Beschreibung der
Statistik.
        </para>
    </listitem>
</itemizedlist>
</para>

<para>
Wenn das Statistikmodul installiert ist, enthält es einige vorkonfigurierte
Reports. Diese können in der Übersicht aufgerufen werden. Wenn die Liste zu
lang für eine Seite wird, kann der Agent durch die verschiedenen Seiten
blättern. Die Liste kann durch klick auf den Spaltenkopf wie gewünscht
geordnet werden. Um einen bestimmten Report zu erzeugen, klicken Sie auf die
Statistiknummer des Reports in der Übersicht. Dadurch gelangen Sie in die
Ansichtsseite des Reports.
</para>

</section>

<section id="stats-viewing-generating">
<title>Ansehen und Generieren von Statistiken</title>

<para>
Aufgabe der "Ansehen"-Oberfläche ist es, dem Agent einen Überblick über die
Vorkonfiguration der Statistik zu ermöglichen.
</para>

<para>
<screenshot id="stats-view-screenshot" >
<screeninfo>Ansicht einer Statistik</screeninfo> <graphic
fileref="screenshots/stats-view.png" scale="40" srccredit="stats-view -
Screenshot" /></screenshot>
</para>

<para>
<emphasis>Abb. 19.3. Ansicht einer Statistik.</emphasis>
</para>

<para>
Konfigurationseinstellungen für einen Report können in den Optionen der
Ansichtsseite eingestellt werden. Der Ersteller des Reports und jeder Agent
mit den benötigten Rechten kann diese Einstellungen vornehmen.
</para>

<para>
Konkret wird auf dieser Seite folgendes angezeigt:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
        Verfügbare Aktionen:
        </para>

        <para>
        <itemizedlist>
            <listitem>
                <para>
                    <emphasis>Zurück zur Übersicht</emphasis>.  Zurück zur Übersichtsliste der
Reports.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Bearbeiten</emphasis>. Die aktuelle Statistik bearbeiten (benötigt
"rw"-Rechte).
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Löschen</emphasis>. Die aktuelle Statistik löschen (benötigt
"rw"-Rechte).
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Konfiguration exportieren</emphasis>. Exportieren einer
Statistikkonfiguration mittels Dateidownload ("rw"-Rechte erforderlich).
                </para>

                <para>
                    Verwendung: Mittels der Export- und Importfunktionen können Statistiken
bequem auf Testsystemen entworfen und getestet werden, um dann anschließend
einfach in das Produktivsystem integriert zu werden.
                </para>
            </listitem>
        </itemizedlist>
        </para>
    </listitem>
    <listitem>
        <para>
        Report-Details:
        </para>
        <para>
        <itemizedlist>
            <listitem>
                <para>
                    <emphasis>Statistik-Nr.</emphasis>. Die Nummer der Statistik.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Titel</emphasis>. Titel der Statistik.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Objekt</emphasis>. Objekt, das für die Generierung der Statistik
verwendet wird.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Beschreibung</emphasis>. Ein Auszug aus der Beschreibung der
Statistik.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Format</emphasis>. Ausgabeformat der Statistik. Hierbei stehen je
nach Konfiguration folgende Ausgabeformate zur Verfügung:
                </para>
                <para>
                <itemizedlist>
                    <listitem>
                        <para>
                        CSV.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Drucken.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Liniendiagramm.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Balkendiagramm.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Balkendiagramm (horizontal).
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Punktdiagramm
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Linienpunktdiagramm.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Flächendiagramm.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Tortendiagramm.
                        </para>
                    </listitem>
                </itemizedlist>
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Grafikgröße</emphasis>. Mögliche Größe der Grafik bzw. des
Diagramms. Diese Auswahl bzw. Anzeige erscheint nur, wenn die
Statistikvorkonfiguration ein Diagramm vorsieht bzw. ermöglicht. Alle
generell verwendbaren Grafikgrößen werden durch den otrs-Admin in der
SysConfig definiert. Beim Konfigurieren der Statistiken kann dann der
Ersteller alle relevanten Formate vorselektieren.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Zeilensummierung</emphasis>. Gibt an, ob die Statistik durch eine
Spalte ergänzt wird, deren Zellen die Summe der jeweiligen Zeile darstellt.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Spaltensummierung</emphasis>. Angabe, ob die Statistik durch eine
Zeile ergänzt wird, deren Zellen die Summe der jeweiligen Spalte beinhaltet.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Cache</emphasis>. Gibt an, ob die errechneten Statistiken im
Dateisystem gecacht werden.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Gültig</emphasis>. Ist eine vorkonfigurierte Statistik erst im
Entstehen oder darf sie aus bestimmten Gründen temporär nicht mehr
ausgeführt werden so wird das Element "Gültig" auf "ungültig"
gesetzt. Ferner wird dadurch die Schaltfläche "Start" rechts unten am Ende
des Block ausgeblendet. Ein Generieren der Statistik ist somit nicht
möglich.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Erstellt</emphasis>. Erstellungszeit der Statistik.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Erstellt von</emphasis>.  Agent, der die Statistik erstellt hat.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Geändert</emphasis>. Letzte Änderungszeit der Statistik.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Geändert von</emphasis>.  Agent, der die Statistik zuletzt
geändert hat.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>X-Achse</emphasis>. Diese Option erlaubt es dem Agenten, die X-
und Y-Achsen zu vertauschen (Diese Funktion muss vom OTRS-Administrator
freigeschaltet werden).
                </para>
            </listitem>
            <listitem>
                <para>
                Nach den allgemeinen Angaben sieht der Agent die Angaben zur eigentlichen
Statistik. Hierbei kommen grundsätzlich zwei verschiedene Anzeigen zum
Einsatz:
                </para>
                <para>
                <itemizedlist>
                    <listitem>
                        <para>
                            <emphasis>Anzeige statischer Statistiken</emphasis>. Statische
Report-Generatoren können in die Statistik integriert werden (siehe unten).
                        </para>
                        <para>
                        <screenshot>
<screeninfo>Ansicht der statischen Statistik</screeninfo> <graphic
fileref="screenshots/stats-view-static.png" scale="40"
srccredit="stats-view-static - Screenshot" /></screenshot>
                        </para>
                        <para>
                            <emphasis>Abb. 19.4. Ansicht der statischen Statistik.</emphasis>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <emphasis>Anzeige dynamischer Statistiken</emphasis> Dynamische Statistiken
können auf zweierlei Weise angezeigt werden:
                        </para>
                        <para>
                        <itemizedlist>
                            <listitem>
                                <para>
                                    <emphasis>Unveränderbare Einstellungen</emphasis>. In diesem Fall hat der
Ersteller der Statistik dem Agent, der eine Statistik generieren will,
keinen Freiraum für Veränderungen gelassen.
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    <emphasis>Veränderbare Einstellungen</emphasis>. Bei derartigen Statistiken
ist es dem Agent noch erlaubt die vorkonfigurierte Statistik zu verändern.
                                </para>
                            </listitem>
                        </itemizedlist>
                        </para>
                    </listitem>
                </itemizedlist>
                </para>
            </listitem>
        </itemizedlist>
        </para>
    </listitem>
</itemizedlist>
</para>

<para>
Um eine Statistik zu generieren, muss abschließend lediglich der
"Start"-Button am rechten unteren Ende des Blocks gedrückt werden. Sollte
einmal der "Start"-Button nicht sichtbar sein, kann dies zwei Ursachen
haben:
</para>

<para>
<orderedlist numeration="arabic" >
    <listitem>
        <para>
        die Statistik wurde auf ungültig gesetzt und damit deaktiviert.
        </para>
    </listitem>
    <listitem>
        <para>
        die Statistik wurde nicht sauber konfiguriert und ist noch nicht
lauffähig. Ist dies der Fall, findet man die nötigen Informationen im
Notification-Bereich von OTRS (unterhalb der Navigationsleiste).
        </para>
    </listitem>
</orderedlist>
</para>

<para>
Bei falschen Einstellungen auf der Ansichtsseite wird nach Drücken des
"Start"-Button wieder die Ansichtseite gezeigt und im Notificationbereich
darauf hingewiesen, welche Eingaben falsch waren.
</para>
</section>

<section id="stats-modify-new">
<title>Bearbeiten / Neu</title>

<para>
Agenten mit Schreibrechten können existierende Report-Konfigurationen
bearbeiten, indem sie die Bearbeitungsmaske des Statistikmoduls
aufrufen. Altertativ können sie einen neuen Report erstellen. Die
zugehörigen Masken können folgendermaßen aufgerufen werden:
</para>

<para>
<orderedlist numeration="arabic">
<listitem>
    <para>
    Durch den Knopf "Bearbeiten" in der Statistikansicht.
    </para>
</listitem>
<listitem>
    <para>
    Durch den "Neu"-Link im Statistikmenü der Navigationsleiste, oder durch den
Knopf "Hinzufügen" in der Übersichtsseite.
    </para>
</listitem>
</orderedlist>
</para>

<para>
Das Bearbeiten der Statistiken erfolgt in vier Schritten mit Hilfe eines
Assistenten bzw. Wizards:
</para>

<para>
<orderedlist numeration="arabic">
<listitem>
    <para>
    Allgemeine Angaben zur Statistik.
    </para>
</listitem>
<listitem>
    <para>
    Festlegen des Elements für die X-Achse.
    </para>
</listitem>
<listitem>
    <para>
    Festlegen der Wertereihen.
    </para>
</listitem>
<listitem>
    <para>
    Festlegen der Einschränkungen des Reports.
    </para>
</listitem>
</orderedlist>
</para>

<para>
Die Punkte 2-4 werden nur für dynamisch zusammengestellte Statistiken
benötigt. Benutzt man eine statische Statistik ist man mit dem Einfügen der
allgemeinen Angaben in Punkt 1. bereits fertig.
</para>

<para>
Für alle Eingabeoberflächen des Statistik-Moduls gilt: Im Anschluss an das
jeweilige Eingabeformular findet der Benutzer Informationen zur Bedienung
der Seite.
</para>

<para>
Sollte es dennoch zu fehlerhaften Eingaben kommen, wird die zuvor
bearbeitete Oberfläche wieder geladen. Dabei wird die Seite um Informationen
zur fehlerhaften Eingabe ergänzt. Diese Informationen findet man im
Notificationbereich von OTRS. Erst nachdem ein Formular korrekt ausgefüllt
wurde, gelangt man zur nächsten Eingabeoberfläche.
</para>

<para>
<orderedlist numeration="arabic" >
<listitem>
    <para>
        <emphasis>Allgemeine Angaben</emphasis>. Dies ist die erste Seite des
Assistenten.
    </para>

    <para>
    <screenshot>
<screeninfo>Allgemeine Angaben</screeninfo> <graphic
fileref="screenshots/stats-edit-general.png" scale="40"
srccredit="stats-edit-general - Screenshot" /></screenshot>
    </para>

    <para>
        <emphasis>Abb. 19.5. Allgemeine Angaben zur Statistik bearbeiten.</emphasis>
    </para>


    <para>
        Folgende allgemeine Angaben und Einstellungen der Statistik können geändert
werden:
    </para>

    <para>
    <itemizedlist>
        <listitem>
            <para>
                <emphasis>Titel</emphasis>. Er sollte kurz und prägnant die Aufgabe der
Statistik wiedergeben.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Beschreibung</emphasis>. Hier werden Informationen eingetragen,
die einen tieferen Einblick in die Aufgabenstellung, Art der
Konfigurationsparameter, usw. erlauben.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Dynamisches Objekt</emphasis>. Sollte die OTRS-Installation über
mehrere dynamische Objekte verfügen, kann hier das gewünschte Objekt
ausgewählt werden. Die Objekte sind jeweils auf die Anforderungen des
entsprechenden Moduls ausgelegt.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Statische Datei</emphasis>. An dieser Stelle kann eine gewünschte
statische Datei ausgewählt werden. Diese Auswahl wird für gewöhnlich nicht
erscheinen, da nur die statischen Dateien angezeigt werden, die noch keiner
Statistik zugeordnet wurden! Wenn der Punkt "Statische Datei" angezeigt
wird, ist es wichtig im Formular durch die Auswahl des Optionsfelds die
gewünschte Generierungsart auszuwählen (Dynamisch durch ein dynamisches
Objekt oder statisch durch eine Datei). Wird eine statische Datei ausgewählt
entfallen die Eingabeoberflächen 2-4, da die statische Datei die nötigen
Konfigurationen bereits mitbringt.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Rechtevergabe</emphasis>. Durch die Rechtevergabe kann man regeln,
welche Gruppen (und dadurch welche Agents) die vorkonfigurierten Statistiken
später ansehen und generieren können. So können die verschiedenen
Statistiken auf die verschiedenen Abteilungen und Arbeitsgruppen aufgeteilt
werden, die diese benötigen. Eine Mehrfachauswahl ist dabei möglich.
            </para>

            <para>
                Beispiel 1: Die Gruppe "stats" wurde ausgewählt. Der Report kann von allen
Nutzern verwendet werden, die mindestens "ro"-Rechte für die Gruppe "stats"
haben. Diese Berechtigung ist die Voreinstellung.
            </para>

            <para>
                Beispiel 2: Es wurde eine Gruppe namens "sales" selektiert. Alle Benutzer
die ro-Rechte in der Gruppe "sales" haben können nun diese Statistik im
Ansichtsmodus sehen und generieren. Anderen Benutzern, die in der Lage sind
Statistiken zu generieren wird dann diese Statistik nicht angeboten.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Format</emphasis>. Ausgabeformat der Statistik. Hierbei stehen je
nach Konfiguration folgende Ausgabeformate zur Verfügung:
            </para>

            <para>
            <itemizedlist>
                <listitem>
                    <para>
                        CSV.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        Drucken.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        Liniendiagramm.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        Balkendiagramm.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        Balkendiagramm (horizontal).
                    </para>
                </listitem>
                <listitem>
                    <para>
                        Punktdiagramm.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        Linienpunktdiagramm.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        Flächendiagramm.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        Tortendiagramm.
                    </para>
                </listitem>
            </itemizedlist>
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Grafikgröße</emphasis>. Hier kann ausgewählt werden, in welchen
Größen (Pixel) die Diagramme ausgegeben werden dürfen. Diese Auswahl ist nur
sinnvoll, wenn unter dem Punkt "Format" ein grafisches Ausgabeformat
ausgewählt wurde. Alle generell verwendbaren Grafikgrößen werden durch den
OTRS-Admin in der SysConfig definiert. Bei der Konfiguration der Statistiken
kann der Ersteller alle relevanten Formate vorselektieren.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Zeilensummierung</emphasis>. Wird im "Ja" ausgewählt, wird die
Statistik durch eine Spalte ergänzt, deren Zellen die Summe der jeweiligen
Zeile darstellt.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Spaltensummierung</emphasis>. Angabe, ob die Statistik durch eine
Zeile ergänzt wird, deren Zellen die Summe der jeweiligen Spalte
beinhaltet.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Cache</emphasis>. Wird im "Ja" ausgewählt, werden die errechneten
Statistiken im Dateisystem gecacht. Dies spart Rechenleistung und Zeit,
sollte genau diese Statistik wieder aufgerufen werden. Diese Funktion ist
jedoch nur sinnvoll, wenn sichergestellt ist, dass sich der Inhalt der
Statistik nicht mehr ändert. Dies ist genau zu prüfen, bevor man die
Cachingfunktion nutzt.
            </para>

            <para>
                Caching wird automatisch verhindert, wenn die Statistik keinerlei
Zeitangaben enthält (es kommen laufend neue Daten hinzu) oder wenn eine
Zeitangabe in der Zukunft liegt.
            </para>

            <para>
                Sollte eine Statistik zwischenzeitlich wieder bearbeitet werden, werden alle
gecachten Daten wieder gelöscht.
            </para>
        </listitem>
        <listitem>
            <para>
							<emphasis>Gültig</emphasis>. Ist eine vorkonfigurierte Statistik erst im
Entstehen oder darf sie aus bestimmten Gründen temporär nicht mehr
ausgeführt werden so wird das Element "Gültig" auf "ungültig"
gesetzt. Ferner wird dadurch die Schaltfläche "Start" rechts unten am Ende
des Block ausgeblendet. Ein Generieren der Statistik ist somit nicht
möglich.
            </para>
        </listitem>
    </itemizedlist>
    </para>
</listitem>
<listitem>
    <para>
        <emphasis>Definition des Elements für die X-Achse</emphasis>. Hier wird
eingestellt welches Element für die Darstellung der X-Achse verwendet wird,
bzw. bei Tabellen, welche Spaltenbezeichnung die Statistik bekommt.
    </para>

    <para>
    <screenshot>
<screeninfo>Festlegen des Elements für die X-Achse.</screeninfo> <graphic
fileref="screenshots/stats-edit-xaxis.png" scale="40"
srccredit="stats-edit-xaxis - Screenshot" /></screenshot>
    </para>

    <para>
        <emphasis>Abb. 19.6. Definition des Elements für die X-Achse.</emphasis>
    </para>

    <para>
    Als erstes wählt man ein Element per Optionsfeld aus. Anschließend müssen
zwei oder mehr Attribute des Elements selektiert werden. Werden keine
Attribute des Elements ausgewählt, werden alle Attribute verwendet, auch
solche die nach der Konfiguration der Statistik hinzukommen.
    </para>

    <para>
    Entfernt man den Haken "Fixiert" in der Checkbox, kann der Agent, der die
Statistik erstellt, die Attribute des entsprechenden Elements in der
"Ansehen"-Oberfläche verändern.
    </para>

    <para>
    Eine Besonderheit stellen Zeitelemente dar, hier ist die Zeitspanne und die
Skalierung anzugeben. Die Art und Anzahl der Elemente ergibt sich durch das
verwendete dynamische Objekt und ist von Objekt zu Objekt verschieden.
    </para>

    <para>
    Wurden alle Eingaben richtig getätigt, gelangt man nach der Auswahl des
"Weiter" Schalters zu dem Formular "Wertereihen". Ebenfalls gibt es die
Möglichkeit, einen Bearbeitungsschritt zurück zu gehen und nochmals die
Oberfläche "Allgemeine Angaben" zu bearbeiten.
    </para>
</listitem>
<listitem>
    <para>
        <emphasis>Wertereihen</emphasis>.
    </para>

    <para>
    Im dritten Schritt der Vorkonfiguration einer Statistik werden die
Wertereihen der Statistik festgelegt. Sie bilden später die einzelnen Grafen
des Diagramms (grafische Darstellung) oder die einzelnen Reihen
(tabellarische Darstellung).
    </para>

    <para>
    <screenshot>
<screeninfo>Festlegen der Wertereihen</screeninfo> <graphic
fileref="screenshots/stats-edit-valueseries.png" scale="40"
srccredit="stats-edit-valueseries - Screenshot" /></screenshot>
    </para>

    <para>
        <emphasis>Abb. 19.7. Festlegen der Wertereihen.</emphasis>
    </para>

    <para>
    Wird ein Element selektiert, entspricht jedes ausgewählte Attribut einer
Wertereihe.
    </para>

    <para>
    <example id="stats-value-series-1">
    <title>Festlegen einer Wertereihe bei einem Element</title>

    <para>
    Element Queue:
    </para>

    <para>
    <itemizedlist>
        <listitem>
            <para>
            Wertereihe 1 = Raw
            </para>
        </listitem>
        <listitem>
            <para>
            Wertereihe 2 = Junk
            </para>
        </listitem>
        <listitem>
            <para>
            ....
            </para>
        </listitem>
    </itemizedlist>
    </para>
    </example>
    </para>

    <para>
    Werden zwei Elemente selektiert, wird jedes ausgewählte Attribut des ersten
Elements kombiniert mit einem Attribut des zweiten Elements zu einer
Wertereihe.
    </para>

    <para>
    <example id="stats-value-series-2" >
    <title>Festlegen einer Wertereihe bei zwei Elementen </title>

    <para>
    Element 1 Queue, Element 2 Status:
    </para>

    <para>
    <itemizedlist>
        <listitem>
            <para>
            Wertereihe 1 = Raw - offen
            </para>
        </listitem>
        <listitem>
            <para>
            Wertereihe 2 = Raw - erfolgreich geschlossen
            </para>
        </listitem>
        <listitem>
            <para>
            Wertereihe 3 = Junk - offen
            </para>
        </listitem>
        <listitem>
            <para>
            Wertereihe 4 = Junk - erfolgreich geschlossen
            </para>
        </listitem>
    </itemizedlist>
    </para>
    </example>
    </para>

    <para>
    Die Auswahl von drei oder mehr Elementen ist nicht sinnvoll und wird deshalb
durch eine Fehlermeldung verhindert.
    </para>

    <para>
    Ferner gelten noch die gleichen Bedingungen zur Auswahl der Attribute und
zur "Fixiert" Checkbox wie bei der "X-Achsen" Auswahl.
    </para>

    <para>
    <itemizedlist>
        <listitem>
            <para>
            Werden keine Attribute des Elements ausgewählt, werden alle Attribute
verwendet, auch solche die nach der Konfiguration der Statistik
hinzukommen.
            </para>
        </listitem>
        <listitem>
            <para>
            Entfernt man den Haken "Fixiert" in der Checkbox, kann der Agent der die
Statistik erstellt, die Attribute des entsprechenden Elements verändern.
            </para>
        </listitem>
    </itemizedlist>
    </para>
</listitem>
<listitem>
    <para>
        <emphasis>Festlegen der Einschränkungen</emphasis>. Vierter und letzter
Schritt bei der Vorkonfiguration ist das Festlegen der Einschränkungen. Hier
ist es möglich die Ergebnisse einer Statistik durch die Angabe von
Bedingungen einzuschränken. Vergleichbar ist dies mit Eingaben in eine
Such-Oberfläche.
    </para>

    <para>
    <screenshot>
<screeninfo>Festlegen der Einschränkungen</screeninfo> <graphic
fileref="screenshots/stats-edit-restrictions.png" scale="40"
srccredit="stats-edit-restrictions - Screenshot" /></screenshot>
    </para>

    <para>
        <emphasis>Abb. 19.8. Festlegen der Einschränkungen.</emphasis>
    </para>

    <para>
    Nachdem man alle Einschränkungen getätigt hat, drückt man den Button
"Abschließen". Dadurch beendet man die Vorkonfiguration der Statistik und
gelangt in die "Ansehen" Oberfläche.
    </para>
</listitem>
</orderedlist>
</para>
</section>

<section id="stats-import">
<title>Importieren</title>

<para>
Durch die Auswahl des "Import"-Menüpunkts im Statistikmenü der
Navigationsleiste oder durch den "Import"-Knopf in der Übersichtsmaske
gelangt man in die Importoberfläche ("rw"-Rechte erforderlich).
</para>

<para>
<screenshot>
<screeninfo>Die Import-Oberfläche</screeninfo> <graphic
fileref="screenshots/stats-import.png" scale="40" srccredit="stats-import -
Screenshot" /></screenshot>
</para>

<para>
    <emphasis>Abb. 19.9. Die Import-Oberfläche.</emphasis>
</para>

<para>
Durch sie können Statistiken importiert werden. Dies ist im Zusammenhang mit
der Exportfunktion des Moduls eine sehr hilfreiche Funktionalität. So können
Statistiken bequem auf Testsystemen entworfen und getestet werden, um sie
später auf dem Produktivsystem zu importieren.
</para>

<para>
Der Import geschieht dabei ganz einfach durch einen
Dateiupload. Anschließend gelangt man automatisch in die Detailansicht der
importierten Statistik.
</para>
</section>

</section>

<section id="stats-managing-the-module">
<title>Verwaltung des Statistik-Moduls durch den OTRS-Administrator</title>

<para>
In diesem Abschnitt werden die Aufgaben und Möglichkeiten des
OTRS-Administrators in Bezug auf das Statistikmodul angesprochen.
</para>

<section id="stats-permissions" >
<title>Rechte, Gruppen und Queues</title>

<para>
Durch die Installation des Statistikmoduls werden keine neuen Queues
oder/und Gruppen angelegt.
</para>

<para>
Durch die Standardkonfiguration der Modulregistrierung haben alle Agenten,
die Rechte in der "stats"-Gruppe haben, Zugriff auf das Statistikmodul.
</para>

<para>
Zugangsmöglichkeiten aufgrund der Rechte:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
            <emphasis>rw</emphasis>. Darf Statistiken konfigurieren.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>ro</emphasis>. Darf vorkonfigurierte Statistiken generieren.
        </para>
    </listitem>
</itemizedlist>
</para>

<para>
Ob nun dem jeweiligen Agenten, der später vorkonfigurierte Statistiken
generieren darf, ro-Rechte in der "stats" Gruppe zugewiesen werden oder in
der Modulregistrierung der SysConfig die dem Agent entsprechenden Gruppen
ergänzt werden, bleibt dem OTRS-Administrator und dessen Anforderungen
überlassen.
</para>
</section>

<section id="stats-sysconfig" >
<title>Die SysConfig (Verwaltung der Systemkonfiguration)</title>

<para>
Die SysConfig-Gruppen <link
linkend="Framework:Core::Stats">Framework:Core::Stats</link>, <link
linkend="Framework:Core::Stats::Graph">Framework:Core::Stats::Graph</link>
und <link
linkend="Framework:Frontend::Agent::Stats">Framework:Frontend::Agent::Stats</link>
enthalten alle Konfigurationsparameter zur grundlegenden Einstellung des
Statistik-Moduls. Weiterhin regelt der Konfigurationsparameter <link
linkend="Framework:Frontend::Agent::ModuleRegistration:Frontend::Module_AgentStats">$Self-&gt;{'Frontend::Module'}-&gt;{'AgentStats'}</link>die
Anordnung und Registrierung der Module und Icons innerhalb des
Statistik-Moduls selbst.
</para>
</section>

</section>

<section id="stats-managing-the-stats-module-by-the-sysadmin" >
<title>Verwaltung des Statistik-Moduls durch den System-Administrator</title>

<para>
Grundsätzlich ist bei der Bedienung, Konfiguration und Wartung des
Statistikmoduls kein System-Administrator notwendig. An dieser Stelle sollen
nur einige Hintergrundinformationen für den System-Administrator gegeben
werden.
</para>

<note>
<para>
Pfadangaben beziehen sich auf Unterverzeichnisse des OTRS-Homeverzeichnisses
(meist <filename>/opt/otrs</filename>).
</para>
</note>

<section id="stats-db-table" >
<title>Datenbanktabelle</title>

<para>
Alle Statistikkonfigurationen werden in XML umgesetzt und verwaltet. Dies
bedeutet unter anderem, dass alle Statistikkonfigurationen in der
Datenbanktabelle "xml_storage" gespeichert werden. Diese Tabelle wird auch
von anderen Modulen benutzt, deren Inhalte im XML-Format dargestellt werden.
</para>

</section>

<section id="stats-filelist" >
<title>Auflistung aller Dateien</title>

<para>
Folgende Dateien sind für die fehlerfreie Funktion des Statistikmoduls
notwendig.
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
        <filename>Kernel/System/Stats.pm</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Modules/AgentStats.pm</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/System/CSV.pm</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsOverview.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsDelete.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsEditSpecification.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsEditRestrictions.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsEditXaxis.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsEditValueSeries.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsImport.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsPrint.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsView.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/System/Stats/Dynamic/Ticket.pm</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>bin/otrs.GenerateStats.pl</filename>
        </para>
    </listitem>
</itemizedlist>
</para>
</section>

<section id="stats-caching" >
<title>Caching</title>

<para>
Bei der Vorkonfiguration von Statistiken kann eingestellt werden, ob die
Ergebnisse einer Statistik gecachet werden oder nicht. Statistikergebnisse,
die in den Cache geschrieben werden sollen, werden als Datei im Verzeichnis
<filename>var/tmp</filename> der OTRS-Installation gespeichert (meist
<filename>/opt/otrs/var/tmp</filename>).
</para>

<para>
Alle gecacheten Statistiken sind dabei durch das Präfix "Stats" zu erkennen.
</para>

<para>
Sollten diese Dateien verloren gehen, ist dies nicht weiter schlimm. Beim
nächsten Aufruf dieser Statistik kann das Statistikmodul diese Datei nicht
mehr finden und muss deshalb die Statistik neu errechnen, was etwas Zeit
beanspruchen kann.
</para>
</section>

<section id="stats-mkstats" >
<title>otrs.GenerateStats.pl</title>

<para>
Diese Datei befindet sich im Verzeichnis <filename>bin/</filename>. Durch
sie ist es möglich, Statistiken auf der Kommandozeile zu generieren.
</para>

<para>
Exemplarisch soll hierzu folgender Kommandozeilenaufruf angegeben werden:
</para>

<para>
<programlisting>
bin> perl otrs.GenerateStats.pl -n 10004 -o /output/dir
</programlisting>
</para>

<para>
    <emphasis>Skript 19.1. Generieren einer Statistik auf der
Kommandozeile.</emphasis>
</para>

<para>
Dabei wird eine Statistik aus der Statistikkonfiguration "Stat# 10004"
generiert und als csv in das Verzeichnis <filename>/output/dir</filename>
gespeichert.
</para>

<para>
Ferner kann die generierte Statistik auch per Email versandt werden. Mehr
Informationen erhält man wie in Skript 19.2 geschildert.
</para>

<para>
<programlisting>
bin> perl otrs.GenerateStats.pl --help
</programlisting>
</para>

<para>
    <emphasis>Skript 19.2. Aufruf der Hilfe von
otrs.GenerateStats.pl.</emphasis>
</para>

</section>

<section id="stats-cron" >
<title>Automatisiertes Generieren von Statistiken - Cron</title>

<para>
Sinnvoll ist das Generieren von Statistiken per Hand über die Kommandozeile
natürlich nicht unbedingt, da das Statistikmodul eine geeignete grafische
Oberfläche bietet. Interessant wird die Generierung von Statistiken per
Kommandozeile aber in Kombination mit einem Cronjob.
</para>

<para>
Folgendes Szenario ist denkbar: Ein Abteilungsleiter wünscht pünktlich zum
ersten eines Monats eine Statistik zum abgelaufenen Monat. Durch die
Kombination Cronjob und Kommandozeilenaufruf ist man in der Lage
automatisiert zu Beginn eines Monats dem Abteilungsleiter die gewünschte
Statistik per Email zukommen zu lassen.
</para>

</section>

<section id="stats-static" >
<title>Statische Statistiken</title>

<para>
Das Statistikmodul bietet die Möglichkeit statische Statistiken zu
generieren. Für jede statische Statistik gibt es eine Datei, in der die
Inhalte der Statistik genau definiert sind.
</para>

<para>
Vorteil dieser Art von Statistik ist, dass dadurch sehr komplexe Statistiken
erzeugt werden können. Der Nachteil ist wiederum die mangelnde Flexibilität
dieser Statistiken.
</para>

<para>
Gespeichert werden diese Dateien unter folgendem Pfad:
<filename>Kernel/System/Stats/Static/</filename>.
</para>
</section>

<section id="stats-using-old-stats" >
<title>Wiederverwerten alter statischer Statistiken</title>

<para>
Bereits OTRS 1.3 und 2.0 boten die Möglichkeit Statistiken zu
generieren. Eine Vielzahl der Statistiken, die für OTRS-Versionen 1.3 und
2.0 speziell auf Kundenwunsch entwickelt wurden, können wiederverwendet
werden.
</para>

<para>Diese Dateien müssen hierzu lediglich aus dem Pfad
<filename>Kernel/System/Stats/</filename> in den Pfad
<filename>Kernel/System/Stats/Static/</filename> verschoben werden. Ferner
muss die Paketangabe des jeweiligen Skripts um "::Static" ergänzt werden.
</para>

<para>
Das folgende Beispiel zeigt die Erweiterung des Paketnamens.
</para>

<para>
<programlisting>
    package Kernel::System::Stats::AccountedTime;
</programlisting>
</para>

<para>
<programlisting>
    package Kernel::System::Stats::Static::AccountedTime;
</programlisting>
</para>
</section>

<section id="stats-default-stats" >
<title>Standardstatistiken</title>

<para>"Man muss das Rad nicht immer neu erfinden."
</para>

<para>
Deshalb liefert das Statistikmodul automatisch Standardstatistiken
mit. Statistiken, die für alle OTRS-Benutzer interessant sind, werden
zukünftig als Defaultstatistik im Statistik-Modul-Paket ergänzt. Gespeichert
werden die Defaultstatistiken im XML-Format des Statistikmoduls im
Verzeichnis <filename>scripts/test/sample/</filename>.
</para>

</section>

</section>

</chapter>